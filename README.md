# Конвертер Excel → CSV (aiogram 3, Python 3.12)

## Требования
- Python 3.12
- Токен бота от BotFather (`BOT_TOKEN`)

## Установка
```bash
python -m venv .venv
.venv\\Scripts\\activate
pip install -r requirements.txt
```

## Настройка окружения
Создайте файл `.env` по примеру:
```
BOT_TOKEN=ваш_токен
DB_PATH=bot.sqlite3
```

## Инициализация БД
Таблица `user` должна содержать ID разрешённых пользователей.
Перед запуском заполните её вручную (например, через sqlite3) или добавьте
необходимые вставки в `database/init_db.py`.
Мотивационные цитаты загружаются автоматически из `motivation.csv`
при первом запуске.

## Запуск
```bash
python main.py
```

## Как работает
- Бот принимает только `.xlsx`.
- Конвертирует в CSV с разделителем запятая и кодировкой `cp1251`
  (сохраняет имя файла, меняет расширение на `.csv`).
- Отправляет файл вместе со случайной цитатой из таблицы `motivation`.
- Доступ — только для пользователей, чьи `ID` занесены в таблицу `user`.

